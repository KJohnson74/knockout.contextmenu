/* knockout.contextmenu v0.1.13
   Nicol√°s Escalante - nlante@gmail.com
   Issues: https://github.com/nescalante/knockout.contextmenu/issues
   License: MIT */

!function(a){"use strict";function b(b,c){function d(){f&&f.parentNode&&f.parentNode.removeChild(f),f=null}function e(a){for(var b=0;b<g.length;b++)if(g[b].element===a)return g[b]}var f,g=[],h=b.utils,i=h.registerEventHandler,j=b.isObservable;i(c,"click",function(a){a.defaultPrevented||d()}),h.contextMenu={getMenuFor:function(a,b){var c=e(a);return c?c.get(b):void 0},openMenuFor:function(a,b){var c=e(a);return c?c.open(b):void 0}},b.bindingHandlers.contextMenu={init:function(b,e,h,k){function l(a){return a.pageX?a.pageX:a.clientX?a.clientX+(c.documentElement.scrollLeft||c.body.scrollLeft):null}function m(a){return a.pageY?a.pageY:a.clientY?a.clientY+(c.documentElement.scrollTop||c.body.scrollTop):null}function n(a){var e;return q=o(a),e=q.element,d(),a?(e.style.top=m(a)+"px",e.style.left=l(a)+"px",a.preventDefault()):(e.style.top=b.offsetTop+b.offsetHeight+"px",e.style.left=b.offsetLeft+b.offsetWidth+"px"),(c.body||c).appendChild(e),f=e,q}function o(){function a(a){var b=p(a),c=[];b.isVisible&&(d=d||b.isBoolean,b.isChecked&&c.push("checked"),b.isDisabled&&c.push("disabled"),b.isSeparator&&c.push("separator"),b.url&&c.push("with-url"),e.push('<li class="'+c.join(" ")+'">'+b.html+"</li>"),g.push(b.action)),h.push(b)}var b,d=!1,e=[],g=[],h=[];for(var j in r)a(j);return e.length&&(b=c.createElement("div"),b.className=t,b.innerHTML='<ul class="'+(d?"has-checks":"")+'">'+e.join("")+"</ul>",e.forEach(function(a,c){i(b.children[0].children[c],"click",function(a){var b=g[c](k,a);!b&&a&&a.preventDefault()})})),{element:b,items:h,open:n,hide:function(){b&&b.parentNode&&b.parentNode.removeChild(b),f=null}}}function p(b){function c(a,c){var d=b+" option must have an action or an url.";if(m)return!1;if(j(f)&&"boolean"==typeof f())f(!f());else if("object"==typeof f){if(!(f.action||g||n))throw d;f.action&&(j(f.action)&&"boolean"==typeof f.action()?f.action(!f.action()):f.action(a,c))}else{if("function"!=typeof f)throw d;f(a,c)}return!0}var d="",e="",f=r[b]||{},g=j(f.url)?f.url():f.url,h=f.visible===a||null===f.visible||j(f.visible)&&f.visible()||!j(f.visible)&&!!f.visible,i=!1,k=!f.disabled||j(f.disabled)&&!f.disabled()||j(f.enabled)&&f.enabled()||!j(f.enabled)&&!!f.enabled,l=!1,m=!k,n=!!r[b].separator;return n||(d=j(f.text)?f.text():f.text,d||(d=b),e=g?'<a href="'+g+'">'+d+"</a>":d),(j(f)&&"boolean"==typeof f()||j(f.action)&&"boolean"==typeof f.action())&&(l=!0,(f.action&&f.action()||"function"==typeof f&&f())&&(i=!0)),{html:e,text:d,url:g,isVisible:h,isChecked:i,isEnabled:k,isDisabled:m,isBoolean:l,isSeparator:n,action:c}}var q,r=e()||{},s=h(),t=s.contextMenuClass||"context-menu";s.bindMenuOnClick&&i(b,"click",n),(s.bindMenuOnContextMenu===a||s.bindMenuOnContextMenu)&&i(b,"contextmenu",n),g.push({element:b,get:function(){return q},open:n,hide:function(){q&&q.hide()}})}}}typeof ko!=a+""&&typeof document!=a+""&&b(ko,document),typeof module!=a+""&&module.exports&&(module.exports=b)}();