/* knockout.contextmenu v0.1.10
   Nicol√°s Escalante - nlante@gmail.com
   Issues: https://github.com/nescalante/knockout.contextmenu/issues
   License: MIT */

!function(a){"use strict";function b(b,c){function d(){f&&f.parentNode&&f.parentNode.removeChild(f),f=null}function e(a){for(var b=0;b<g.length;b++)if(g[b].element===a)return g[b]}var f,g=[],h=b.utils,i=h.registerEventHandler;i(c,"click",function(a){a.defaultPrevented||d()}),h.contextMenu={getMenuFor:function(a,b){var c=e(a);return c?c.get(b):void 0},openMenuFor:function(a,b){var c=e(a);return c?c.open(b):void 0}},b.bindingHandlers.contextMenu={init:function(e,h,j,k){function l(a){var b;return o=m(a),b=o.element,d(),a?(b.style.top=a.offsetY+a.target.offsetTop+"px",b.style.left=a.offsetX+a.target.offsetLeft+"px",a.preventDefault()):(b.style.top=e.offsetTop+e.offsetHeight+"px",b.style.left=e.offsetLeft+e.offsetWidth+"px"),(c.body||c).appendChild(b),f=b,o}function m(){function a(a){var b=n(a),c=[];b.isVisible&&(d=d||b.isBoolean,b.isChecked&&c.push("checked"),b.isDisabled&&c.push("disabled"),b.isSeparator&&c.push("separator"),b.url&&c.push("with-url"),e.push('<li class="'+c.join(" ")+'">'+b.html+"</li>"),g.push(b.action)),h.push(b)}var b,d=!1,e=[],g=[],h=[];for(var j in p)a(j);return e.length&&(b=c.createElement("div"),b.className=r,b.innerHTML='<ul class="'+(d?"has-checks":"")+'">'+e.join("")+"</ul>",e.forEach(function(a,c){i(b.children[0].children[c],"click",function(a){var b=g[c](k,a);!b&&a&&a.preventDefault()})})),{element:b,items:h,open:l,hide:function(){b&&b.parentNode&&b.parentNode.removeChild(b),f=null}}}function n(c){function d(a,d){var e=c+" option must have an action or an url.";if(m)return!1;if(b.isObservable(g)&&"boolean"==typeof g())g(!g());else if("object"==typeof g){if(!(g.action||h||n))throw e;g.action&&(b.isObservable(g.action)&&"boolean"==typeof g.action()?g.action(!g.action()):g.action(a,d))}else{if("function"!=typeof g)throw e;g(a,d)}return!0}var e="",f="",g=p[c]||{},h=b.isObservable(g.url)?g.url():g.url,i=g.visible===a||null===g.visible||b.isObservable(g.visible)&&g.visible()||!!g.visible,j=!1,k=!g.disabled||b.isObservable(g.disabled)&&!g.disabled()||b.isObservable(g.enabled)&&g.enabled()||!!g.enabled,l=!1,m=!k,n=!!p[c].separator;return n||(e=b.isObservable(g.text)?g.text():g.text,e||(e=c),f=h?'<a href="'+h+'">'+e+"</a>":e),(b.isObservable(g)&&"boolean"==typeof g()||b.isObservable(g.action)&&"boolean"==typeof g.action())&&(l=!0,(g.action&&g.action()||"function"==typeof g&&g())&&(j=!0)),{html:f,text:e,url:h,isVisible:i,isChecked:j,isEnabled:k,isDisabled:m,isBoolean:l,isSeparator:n,action:d}}var o,p=h()||{},q=j(),r=q.contextMenuClass||"context-menu";q.bindMenuOnClick&&i(e,"click",l),(q.bindMenuOnContextMenu===a||q.bindMenuOnContextMenu)&&i(e,"contextmenu",l),g.push({element:e,get:function(){return o},open:l,hide:function(){o&&o.hide()}})}}}typeof ko!=a+""&&typeof document!=a+""&&b(ko,document),typeof module!=a+""&&module.exports&&(module.exports=b)}();