/* knockout.contextmenu v0.1.12
   Nicol√°s Escalante - nlante@gmail.com
   Issues: https://github.com/nescalante/knockout.contextmenu/issues
   License: MIT */

!function(a){"use strict";function b(b,c){function d(){f&&f.parentNode&&f.parentNode.removeChild(f),f=null}function e(a){for(var b=0;b<g.length;b++)if(g[b].element===a)return g[b]}var f,g=[],h=b.utils,i=h.registerEventHandler;i(c,"click",function(a){a.defaultPrevented||d()}),h.contextMenu={getMenuFor:function(a,b){var c=e(a);return c?c.get(b):void 0},openMenuFor:function(a,b){var c=e(a);return c?c.open(b):void 0}},b.bindingHandlers.contextMenu={init:function(e,h,j,k){function l(a){return a.pageX?a.pageX:a.clientX?a.clientX+(c.documentElement.scrollLeft||c.body.scrollLeft):null}function m(a){return a.pageY?a.pageY:a.clientY?a.clientY+(c.documentElement.scrollTop||c.body.scrollTop):null}function n(a){var b;return q=o(a),b=q.element,d(),a?(b.style.top=m(a)+"px",b.style.left=l(a)+"px",a.preventDefault()):(b.style.top=e.offsetTop+e.offsetHeight+"px",b.style.left=e.offsetLeft+e.offsetWidth+"px"),(c.body||c).appendChild(b),f=b,q}function o(){function a(a){var b=p(a),c=[];b.isVisible&&(d=d||b.isBoolean,b.isChecked&&c.push("checked"),b.isDisabled&&c.push("disabled"),b.isSeparator&&c.push("separator"),b.url&&c.push("with-url"),e.push('<li class="'+c.join(" ")+'">'+b.html+"</li>"),g.push(b.action)),h.push(b)}var b,d=!1,e=[],g=[],h=[];for(var j in r)a(j);return e.length&&(b=c.createElement("div"),b.className=t,b.innerHTML='<ul class="'+(d?"has-checks":"")+'">'+e.join("")+"</ul>",e.forEach(function(a,c){i(b.children[0].children[c],"click",function(a){var b=g[c](k,a);!b&&a&&a.preventDefault()})})),{element:b,items:h,open:n,hide:function(){b&&b.parentNode&&b.parentNode.removeChild(b),f=null}}}function p(c){function d(a,d){var e=c+" option must have an action or an url.";if(m)return!1;if(b.isObservable(g)&&"boolean"==typeof g())g(!g());else if("object"==typeof g){if(!(g.action||h||n))throw e;g.action&&(b.isObservable(g.action)&&"boolean"==typeof g.action()?g.action(!g.action()):g.action(a,d))}else{if("function"!=typeof g)throw e;g(a,d)}return!0}var e="",f="",g=r[c]||{},h=b.isObservable(g.url)?g.url():g.url,i=g.visible===a||null===g.visible||b.isObservable(g.visible)&&g.visible()||!b.isObservable(g.visible)&&!!g.visible,j=!1,k=!g.disabled||b.isObservable(g.disabled)&&!g.disabled()||b.isObservable(g.enabled)&&g.enabled()||!b.isObservable(g.enabled)&&!!g.enabled,l=!1,m=!k,n=!!r[c].separator;return n||(e=b.isObservable(g.text)?g.text():g.text,e||(e=c),f=h?'<a href="'+h+'">'+e+"</a>":e),(b.isObservable(g)&&"boolean"==typeof g()||b.isObservable(g.action)&&"boolean"==typeof g.action())&&(l=!0,(g.action&&g.action()||"function"==typeof g&&g())&&(j=!0)),{html:f,text:e,url:h,isVisible:i,isChecked:j,isEnabled:k,isDisabled:m,isBoolean:l,isSeparator:n,action:d}}var q,r=h()||{},s=j(),t=s.contextMenuClass||"context-menu";s.bindMenuOnClick&&i(e,"click",n),(s.bindMenuOnContextMenu===a||s.bindMenuOnContextMenu)&&i(e,"contextmenu",n),g.push({element:e,get:function(){return q},open:n,hide:function(){q&&q.hide()}})}}}typeof ko!=a+""&&typeof document!=a+""&&b(ko,document),typeof module!=a+""&&module.exports&&(module.exports=b)}();