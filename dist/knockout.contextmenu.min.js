!function(){"use strict";function a(a,b){function c(){d&&d.parentNode&&d.parentNode.removeChild(d),d=null}var d,e=b.onclick,f=[];b.onclick=function(a){a.defaultPrevented||(e&&e(a),c())},a.bindingHandlers.contextMenu={getMenuFor:function(a,b){for(var c=0;c<f.length;c++)if(f[c].element===a)return f[c].get(b)},init:function(e,g,h,i){function j(a){var e=k(a).element;return c(),a&&(e.style.top=a.pageY,e.style.left=a.pageX,a.preventDefault()),(b.body||b).appendChild(e),d=e,e}function k(){function c(a){var b=l(a),c=[];b.isVisible&&(e=e||b.isBoolean,b.isChecked&&c.push("checked"),b.isDisabled&&c.push("disabled"),b.isSeparator&&c.push("separator"),b.url&&c.push("with-url"),f.push('<li class="'+c.join(" ")+'">'+b.html+"</li>"),g.push(b.action)),h.push(b)}var d,e=!1,f=[],g=[],h=[];for(var j in m)c(j);return f.length&&(d=b.createElement("div"),d.className=o,d.innerHTML='<ul class="'+(e?"has-checks":"")+'">'+f.join("")+"</ul>",f.forEach(function(b,c){a.utils.registerEventHandler(d.children[0].children[c],"click",function(a){var b=g[c](i,a);!b&&a&&a.preventDefault()})})),{element:d,items:h}}function l(b){function c(c,d){var e=b+" option must have an action or an url.";if(l)return!1;if(a.isObservable(f)&&"boolean"==typeof f())f(!f());else if("object"==typeof f){if(!(f.action||g||n))throw e;f.action&&(a.isObservable(f.action)&&"boolean"==typeof f.action()?f.action(!f.action()):f.action(c,d))}else{if("function"!=typeof f)throw e;f(c,d)}return!0}var d="",e="",f=m[b]||{},g=a.isObservable(f.url)?f.url():f.url,h=void 0===f.visible||null===f.visible||a.isObservable(f.visible)&&f.visible()||!!f.visible,i=!1,j=!f.disabled(a.isObservable(f.disabled)&&!f.disabled())||a.isObservable(f.enabled)&&f.enabled()||!!f.enabled,k=!1,l=!j,n=!!m[b].separator;return n||(d=a.isObservable(f.text)?f.text():f.text,d||(d=b),e=g?'<a href="'+g+'">'+d+"</a>":d),(a.isObservable(f)&&"boolean"==typeof f()||a.isObservable(f.action)&&"boolean"==typeof f.action())&&(k=!0,(f.action&&f.action()||"function"==typeof f&&f())&&(i=!0)),{html:e,text:d,url:g,isVisible:h,isChecked:i,isEnabled:j,isDisabled:l,isBoolean:k,isSeparator:n,action:c}}var m=g()||{},n=h(),o=n.contextMenuClass||"context-menu";n.bindMenuOnClick&&a.utils.registerEventHandler(e,"click",j),(void 0===n.bindMenuOnContextMenu||n.bindMenuOnContextMenu)&&a.utils.registerEventHandler(e,"contextmenu",j),f.push({element:e,get:k})}}}"undefined"!=typeof ko&&"undefined"!=typeof document&&a(ko,document),"undefined"!=typeof module&&module.exports&&(module.exports=a)}();